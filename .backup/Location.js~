'use strict';

const mongoose = require('mongoose');

const Location = mongoose.model('Location', new mongoose.Schema({
  name: {
    type: String,
    required: true
  },
  address: {
    type: String,
    required: true
  },
  zip: {
    type: Number,
    required: true,
    min: 1000,
    max: 9999
  },
  city: {
    type: String,
    required: true
  },
  chef: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'User'
  },
  minProducts: Number,
  products: {
    type: [{
      type: mongoose.Schema.Types.ObjectId,
      ref: 'Product',
      required: true,
      /*validate: [function (products) {
        let total = products.length;
        console.log(total);
        for(let v in products)
          if(v.isDaily) total--;
        console.log(total);
        return total >= this.minProducts;
      }, 'Der skal mindst v√¶re' + this.minProducts + ' produkter i en lokation!']*/
    }]
  },
  pickupStart: {type: String, default: "12:00" },
  pickupEnd: {type: String, default: "14:00" },
  orderDeadline: {type: String, default: "12:00" },
  hasDaily : {
    type: Boolean,
    required: true,
    default: true
  },
  sub: {
    type: Boolean,
    required: false,
    default: false
  },
  subList: {
    type: Object,
	require: false
  }
}));

module.exports = Location;
